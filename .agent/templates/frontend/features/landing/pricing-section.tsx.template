/**
 * Pricing Section - Feature comparison table with plan tiers
 *
 * @module frontend/features/landing/pricing-section
 * @source ui-tabler/preview/pages/pricing-table.html (106L)
 * @reference https://github.com/tabler/tabler
 * @template S6-M3-F2
 *
 * Pricing comparison table:
 * 1. PricingTable — full feature comparison grid with tiers
 * 2. Tier header with name, price, CTA button
 * 3. Feature rows with check/cross indicators per tier
 * 4. Section subheaders for feature grouping
 *
 * Key patterns from Tabler:
 * - Table-based responsive layout
 * - Feature groups with subheader rows
 * - Highlighted "recommended" tier with colored CTA
 * - Footer row with repeated CTA buttons
 */

import React from "react";

// ─── Types ──────────────────────────────────────────────────────────────────

export interface PricingTier {
  /** Tier name (e.g., "Starter", "Professional") */
  name: string;
  /** Price string (e.g., "$0", "$9/mo") */
  price: string;
  /** CTA button label */
  ctaLabel?: string;
  /** Whether this tier is highlighted/recommended */
  highlighted?: boolean;
  /** Callback when CTA is clicked */
  onSelect?: () => void;
}

export interface PricingFeature {
  /** Feature description */
  name: string;
  /** Availability per tier (true = included, false = not included, string = custom) */
  tiers: (boolean | string)[];
}

export interface PricingSection {
  /** Section label (e.g., "Features", "Reporting", "Support") */
  title: string;
  features: PricingFeature[];
}

export interface PricingTableProps {
  /** Page headline */
  headline?: string;
  /** Page description */
  description?: string;
  /** Pricing tiers (columns) */
  tiers: PricingTier[];
  /** Feature sections (rows grouped) */
  sections: PricingSection[];
  className?: string;
}

// ─── Icons ──────────────────────────────────────────────────────────────────

function CheckIcon() {
  return (
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-success, #16a34a)" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <polyline points="20 6 9 17 4 12" />
    </svg>
  );
}

function CrossIcon() {
  return (
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--color-error, #ef4444)" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
      <line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" />
    </svg>
  );
}

// ─── Styles ─────────────────────────────────────────────────────────────────

const st = {
  card: {
    background: "var(--card-bg, #ffffff)",
    borderRadius: "var(--radius-lg, 12px)",
    border: "1px solid var(--border-color, #e2e8f0)",
    overflow: "hidden",
  } as React.CSSProperties,

  table: {
    width: "100%",
    borderCollapse: "collapse" as const,
    fontSize: "var(--text-sm, 14px)",
  } as React.CSSProperties,

  headerCell: {
    padding: "24px 16px",
    textAlign: "center" as const,
    verticalAlign: "top",
    borderBottom: "1px solid var(--border-color, #e2e8f0)",
  } as React.CSSProperties,

  descriptionCell: {
    padding: "24px 16px",
    width: "50%",
    verticalAlign: "top",
    borderBottom: "1px solid var(--border-color, #e2e8f0)",
  } as React.CSSProperties,

  tierName: {
    textTransform: "uppercase" as const,
    fontSize: "var(--text-xs, 12px)",
    fontWeight: 500,
    color: "var(--text-secondary, #64748b)",
    letterSpacing: "0.05em",
  } as React.CSSProperties,

  tierPrice: {
    fontSize: "var(--text-3xl, 30px)",
    fontWeight: 700,
    color: "var(--text-primary, #1e293b)",
    margin: "12px 0",
  } as React.CSSProperties,

  btn: {
    display: "inline-block",
    width: "100%",
    padding: "10px 16px",
    fontSize: "var(--text-sm, 14px)",
    fontWeight: 500,
    borderRadius: "var(--radius-sm, 6px)",
    cursor: "pointer",
    border: "1px solid var(--border-color, #e2e8f0)",
    background: "var(--bg-primary, #ffffff)",
    color: "var(--text-primary, #1e293b)",
    textAlign: "center" as const,
    textDecoration: "none",
    transition: "background 0.15s ease",
  } as React.CSSProperties,

  btnHighlighted: {
    display: "inline-block",
    width: "100%",
    padding: "10px 16px",
    fontSize: "var(--text-sm, 14px)",
    fontWeight: 500,
    borderRadius: "var(--radius-sm, 6px)",
    cursor: "pointer",
    border: "none",
    background: "var(--color-success, #16a34a)",
    color: "#ffffff",
    textAlign: "center" as const,
    textDecoration: "none",
    transition: "background 0.15s ease",
  } as React.CSSProperties,

  subheader: {
    background: "var(--bg-secondary, #f8fafc)",
    padding: "10px 16px",
    fontWeight: 600,
    fontSize: "var(--text-xs, 12px)",
    textTransform: "uppercase" as const,
    letterSpacing: "0.05em",
    color: "var(--text-secondary, #64748b)",
    borderBottom: "1px solid var(--border-color, #e2e8f0)",
  } as React.CSSProperties,

  featureCell: {
    padding: "12px 16px",
    borderBottom: "1px solid var(--border-color, #e2e8f0)",
    color: "var(--text-primary, #1e293b)",
  } as React.CSSProperties,

  checkCell: {
    padding: "12px 16px",
    borderBottom: "1px solid var(--border-color, #e2e8f0)",
    textAlign: "center" as const,
  } as React.CSSProperties,

  headline: {
    fontSize: "var(--text-xl, 20px)",
    fontWeight: 700,
    color: "var(--text-primary, #1e293b)",
    marginBottom: "8px",
  } as React.CSSProperties,

  description: {
    fontSize: "var(--text-sm, 14px)",
    color: "var(--text-secondary, #64748b)",
    lineHeight: 1.5,
  } as React.CSSProperties,
};

// ─── Pricing Table Component ────────────────────────────────────────────────
// @source ui-tabler/preview/pages/pricing-table.html (9-106L)

export function PricingTable({
  headline = "Pricing plans for teams of all sizes",
  description = "Choose an affordable plan that comes with the best features.",
  tiers,
  sections,
  className,
}: PricingTableProps) {
  return (
    <div style={st.card} className={className}>
      <div style={{ overflowX: "auto" }}>
        <table style={st.table}>
          {/* Header */}
          <thead>
            <tr>
              <td style={st.descriptionCell}>
                <h2 style={st.headline}>{headline}</h2>
                <div style={st.description}>{description}</div>
              </td>
              {tiers.map((tier, i) => (
                <td key={i} style={st.headerCell}>
                  <div style={st.tierName}>{tier.name}</div>
                  <div style={st.tierPrice}>{tier.price}</div>
                  <button
                    style={tier.highlighted ? st.btnHighlighted : st.btn}
                    onClick={tier.onSelect}
                  >
                    {tier.ctaLabel || "Choose plan"}
                  </button>
                </td>
              ))}
            </tr>
          </thead>

          {/* Feature Sections */}
          <tbody>
            {sections.map((section, si) => (
              <React.Fragment key={si}>
                {/* Section Subheader */}
                <tr>
                  <th
                    colSpan={1 + tiers.length}
                    style={st.subheader}
                  >
                    {section.title}
                  </th>
                </tr>

                {/* Feature Rows */}
                {section.features.map((feature, fi) => (
                  <tr key={fi}>
                    <td style={st.featureCell}>{feature.name}</td>
                    {feature.tiers.map((available, ti) => (
                      <td key={ti} style={st.checkCell}>
                        {typeof available === "string" ? (
                          <span>{available}</span>
                        ) : available ? (
                          <CheckIcon />
                        ) : (
                          <CrossIcon />
                        )}
                      </td>
                    ))}
                  </tr>
                ))}
              </React.Fragment>
            ))}
          </tbody>

          {/* Footer */}
          <tfoot>
            <tr>
              <td style={{ padding: "16px" }}></td>
              {tiers.map((tier, i) => (
                <td key={i} style={{ padding: "16px", textAlign: "center" }}>
                  <button
                    style={tier.highlighted ? st.btnHighlighted : st.btn}
                    onClick={tier.onSelect}
                  >
                    {tier.ctaLabel || "Choose plan"}
                  </button>
                </td>
              ))}
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  );
}

// ─── Usage Example ──────────────────────────────────────────────────────────
//
// <PricingTable
//   tiers={[
//     { name: "Free", price: "$0", onSelect: () => {} },
//     { name: "Pro", price: "$19", highlighted: true, onSelect: () => {} },
//     { name: "Enterprise", price: "$49", onSelect: () => {} },
//   ]}
//   sections={[
//     {
//       title: "Features",
//       features: [
//         { name: "Document uploads", tiers: ["10/mo", "100/mo", "Unlimited"] },
//         { name: "RAG pipeline", tiers: [true, true, true] },
//         { name: "Custom models", tiers: [false, true, true] },
//       ],
//     },
//     {
//       title: "Support",
//       features: [
//         { name: "Email support", tiers: [true, true, true] },
//         { name: "Priority support", tiers: [false, true, true] },
//         { name: "Dedicated CSM", tiers: [false, false, true] },
//       ],
//     },
//   ]}
// />

export default PricingTable;
